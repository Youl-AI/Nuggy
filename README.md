# ğŸ° ì´ˆë¯¸ì„¸ ê°ì²´ ë¶„í• ì„ ìœ„í•œ ë°ì´í„° ì¤‘ì‹¬ íŒŒì¸íŠœë‹ ë° í•˜ì´ë¸Œë¦¬ë“œ ì¶”ë¡  íŒŒì´í”„ë¼ì¸ : Nuggy
> **Nuggy: Data-Centric Fine-tuning and Hybrid Inference Pipeline for High-Fidelity Image Matting**

<div align="center">
  <img src="https://img.shields.io/badge/Python-3.8-blue?style=for-the-badge&logo=python&logoColor=white">
  <img src="https://img.shields.io/badge/PyTorch-2.0-EE4C2C?style=for-the-badge&logo=pytorch&logoColor=white">
  <img src="https://img.shields.io/badge/Framework-Streamlit-FF4B4B?style=for-the-badge&logo=streamlit&logoColor=white">
  <img src="https://img.shields.io/badge/Task-Image_Matting-green?style=for-the-badge">
</div>

<br>

> **âš ï¸ Notice**
> ë³¸ í”„ë¡œì íŠ¸ëŠ” **SOTA ëª¨ë¸(IS-Net)ì˜ í•œê³„ë¥¼ ë°ì´í„° ì—”ì§€ë‹ˆì–´ë§ìœ¼ë¡œ ê·¹ë³µ**í•œ ì—°êµ¬ ì§€í–¥ì  í”„ë¡œì íŠ¸ì…ë‹ˆë‹¤.
> í•µì‹¬ ê°€ì¤‘ì¹˜ íŒŒì¼(`best_finetuned_model.pth`)ì€ ìš©ëŸ‰ ë¬¸ì œë¡œ ì¸í•´ ë³„ë„ ë§í¬ë¥¼ í†µí•´ ì œê³µë˜ë©°, ë¦¬í¬ì§€í† ë¦¬ì—ëŠ” **ì¶”ë¡  íŒŒì´í”„ë¼ì¸ ì„¤ê³„ ë° ì›¹ ì„œë¹„ìŠ¤ êµ¬í˜„ ì½”ë“œ**ê°€ í¬í•¨ë˜ì–´ ìˆìŠµë‹ˆë‹¤.

---

## ğŸ“Œ 1. Abstract (ì—°êµ¬ ìš”ì•½)
ê¸°ì¡´ì˜ ê³ í•´ìƒë„ ë°°ê²½ ì œê±° ëª¨ë¸(IS-Net ë“±)ì€ ì¼ë°˜ì ì¸ ê°ì²´ ì¸ì‹ì—ëŠ” íƒì›”í•˜ì§€ë§Œ, **ë™ë¬¼ì˜ ë¯¸ì„¸í•œ í„¸(Fur)ì´ë‚˜ ë¼ì¼“ì˜ ê·¸ë¬¼ë§(Mesh)ê³¼ ê°™ì€ 'ê·¹í•œì˜ ë””í…Œì¼(Extreme Details)'ì„ ë­‰ê°œê±°ë‚˜ ë°°ê²½ìœ¼ë¡œ ì˜¤ì¸í•˜ëŠ” í•œê³„**ê°€ ìˆìŠµë‹ˆë‹¤.

ë³¸ í”„ë¡œì íŠ¸ **Nuggy(ëˆ„ë¼)**ëŠ” ì´ëŸ¬í•œ ë¬¸ì œë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ ëª¨ë¸ ì•„í‚¤í…ì²˜ë¥¼ ë³€ê²½í•˜ëŠ” ëŒ€ì‹ , **ë°ì´í„° ì¤‘ì‹¬(Data-Centric) ì ‘ê·¼ë²•**ì„ í†µí•´ í•™ìŠµ ë¶„í¬ë¥¼ ì¬ì„¤ê³„í–ˆìŠµë‹ˆë‹¤. ë˜í•œ, **TTA(Test Time Augmentation)**ì™€ **ê°€ì´ë””ë“œ í•„í„°(Guided Filter)**ë¥¼ ê²°í•©í•œ í•˜ì´ë¸Œë¦¬ë“œ ì¶”ë¡  íŒŒì´í”„ë¼ì¸ì„ ì œì•ˆí•˜ì—¬ ê²½ê³„ì„  ê²€ì¶œ ì„±ëŠ¥ì„ ê·¹ëŒ€í™”í–ˆìŠµë‹ˆë‹¤.

* **ì„±ê³¼:** ê¸°ì¡´ IS-Net ëŒ€ë¹„ ë™ë¬¼ í„¸ ë° ë¯¸ì„¸ êµ¬ì¡°ë¬¼ì— ëŒ€í•œ **ì‹œê°ì  ì •í™•ë„(Visual Fidelity) ëŒ€í­ í–¥ìƒ** ë° íˆ¬ëª… ê°ì²´ ë°ì´í„°ì— ì˜í•œ ì„±ëŠ¥ ì €í•˜(Degradation) ë¬¸ì œ í•´ê²°.

---

## ğŸ§ 2. Motivation (ì—°êµ¬ ë°°ê²½)
### âŒ The Problem: ì¼ë°˜í™”ëœ ëª¨ë¸ì˜ ë””í…Œì¼ ì†ì‹¤

* ê¸°ì¡´ `DIS5K` ë°ì´í„°ì…‹ìœ¼ë¡œ í•™ìŠµëœ ëª¨ë¸ì€ **'ì „ì²´ì ì¸ í˜•ìƒ(Shape)'** í•™ìŠµì— ìµœì í™”ë˜ì–´ ìˆì–´, 1~2í”½ì…€ ë‹¨ìœ„ì˜ ë¯¸ì„¸í•œ **ê³ ì£¼íŒŒ(High-Frequency) ì •ë³´**ë¥¼ ë…¸ì´ì¦ˆë¡œ ê°„ì£¼í•˜ê³  ì œê±°í•˜ëŠ” ê²½í–¥ì´ ìˆìŠµë‹ˆë‹¤.
* ì´ëŠ” ì‡¼í•‘ëª° ìƒì„¸í˜ì´ì§€ë‚˜ ë””ìì¸ ì‘ì—… ë“± **ì •ë°€í•œ ëˆ„ë¼ ì‘ì—…(High-Fidelity Matting)**ì´ í•„ìš”í•œ ì‹¤ë¬´ í™˜ê²½ì—ì„œ ì¹˜ëª…ì ì¸ ë‹¨ì ì´ ë©ë‹ˆë‹¤.

---

## ğŸ’¡ 3. Methodology (ì œì•ˆ ë°©ë²•)
ìš°ë¦¬ëŠ” íŠ¹ì • ë„ë©”ì¸(í„¸, ì–‡ì€ êµ¬ì¡°)ì— íŠ¹í™”ëœ ë°ì´í„°ì…‹ ì¡°í•©ê³¼ ìˆ˜í•™ì  í›„ì²˜ë¦¬ ì•Œê³ ë¦¬ì¦˜ì„ ê²°í•©í•˜ì—¬ ë¬¸ì œë¥¼ í•´ê²°í–ˆìŠµë‹ˆë‹¤.

### 3.1. Data-Centric Fine-tuning Strategy
ë‹¨ìˆœí•œ ë°ì´í„° ì¦ê°•ì´ ì•„ë‹Œ, ë°ì´í„°ì˜ íŠ¹ì„±ì„ ë¶„ì„í•˜ì—¬ ìµœì ì˜ í•™ìŠµ ì¡°í•©ì„ ì°¾ì•„ëƒˆìŠµë‹ˆë‹¤.

| Dataset | Role | Description |
| :--- | :--- | :--- |
| **DIS5K (Base)** | Regularization | ê¸°ì¡´ ëª¨ë¸ì˜ ì¼ë°˜í™” ì„±ëŠ¥ ìœ ì§€ ë° Catastrophic Forgetting ë°©ì§€ |
| **AM-2k** | **Detail Enhancement** | ë™ë¬¼ í„¸(Animal Fur)ì˜ ë¶ˆê·œì¹™í•œ ê²½ê³„ì„  íŒ¨í„´ ì§‘ì¤‘ í•™ìŠµ |
| **ThinObject-5K** | **Structure Preservation** | ìì „ê±° ì‚´, ë¼ì¼“ ë“± ì–‡ì€ ê¸°í•˜í•™ì  êµ¬ì¡°(Thin Geometry) í•™ìŠµ |

> **ğŸ“‰ Negative Result Analysis (Trans10K Exclusion)**
> ì´ˆê¸° ì‹¤í—˜ì—ì„œ íˆ¬ëª… ë¬¼ì²´ ë°ì´í„°ì…‹(`Trans10K`)ì„ í¬í•¨í–ˆìœ¼ë‚˜, **ë°°ê²½ì´ í”¼ì‚¬ì²´ë¥¼ íˆ¬ê³¼í•˜ëŠ” íŠ¹ì„±**ì´ ë¶ˆíˆ¬ëª… í”¼ì‚¬ì²´(í„¸)ì˜ ê²½ê³„ í•™ìŠµì„ ë°©í•´í•˜ì—¬ ì „ì²´ ì„±ëŠ¥ì„ ì €í•˜ì‹œí‚¤ëŠ” í˜„ìƒì„ ë°œê²¬í–ˆìŠµë‹ˆë‹¤. ì´ë¥¼ **ê³¼ê°íˆ ì œì™¸**í•¨ìœ¼ë¡œì¨ ëª¨ë¸ì˜ í•™ìŠµ ì•ˆì •ì„±ì„ í™•ë³´í–ˆìŠµë‹ˆë‹¤.

### 3.2. Hybrid Inference Pipeline
ë‹¨ì¼ ëª¨ë¸ì˜ ì¶œë ¥ì„ ê·¸ëŒ€ë¡œ ì‚¬ìš©í•˜ì§€ ì•Šê³ , ìˆ˜í•™ì  í•„í„°ë§ì„ í†µí•´ ì˜ˆì¸¡ì„ ë³´ì •í•©ë‹ˆë‹¤.

```mermaid
graph LR
    A[Input Image] --> B{TTA Inference};
    B -- Flip & Ensemble --> C[Raw Mask];
    C --> D[Guided Filter];
    D -- Detail Recovery --> E[Island Removal];
    E -- Morphological Cleaning --> F[Final Output];
    style D fill:#f9f,stroke:#333,stroke-width:2px
    style E fill:#ccf,stroke:#333,stroke-width:2px
```
---

### ğŸ“„ [Part 3-B] íŒŒì´í”„ë¼ì¸ ìƒì„¸ ì„¤ëª… 1 (TTA & Guided Filter)

1.  **Test Time Augmentation (TTA):** ì›ë³¸ê³¼ Flipëœ ì´ë¯¸ì§€ì˜ ì˜ˆì¸¡ í‰ê· ì„ ì‚¬ìš©í•˜ì—¬ ë¶ˆí™•ì‹¤ì„±(Uncertainty) ê°ì†Œ.
2.  **Guided Filter Refinement:** ì›ë³¸ ì´ë¯¸ì§€ $I$ë¥¼ ê°€ì´ë“œë¡œ ì‚¬ìš©í•˜ì—¬ ë§ˆìŠ¤í¬ $p$ì˜ ê²½ê³„ì„ ì„ ë³´ì •.
    $$q_i = a_k I_i + b_k, \quad \forall i \in \omega_k$$
    ì—¬ê¸°ì„œ $a_k, b_k$ëŠ” ìœˆë„ìš° $\omega_k$ ë‚´ì—ì„œ ë¹„ìš© í•¨ìˆ˜ë¥¼ ìµœì†Œí™”í•˜ëŠ” ì„ í˜• ê³„ìˆ˜ì…ë‹ˆë‹¤. ì´ë¥¼ í†µí•´ í„¸ ëë¶€ë¶„ì˜ ì„ ëª…ë„ë¥¼ ë³µì›í•©ë‹ˆë‹¤.
3.  **Morphological Cleaning:** ì£¼ìš” ê°ì²´ì™€ ì—°ê²°ë˜ì§€ ì•Šì€ ë¯¸ì„¸ ë…¸ì´ì¦ˆ(Island)ë¥¼ í¬ê¸° ê¸°ë°˜ìœ¼ë¡œ ì œê±°.
